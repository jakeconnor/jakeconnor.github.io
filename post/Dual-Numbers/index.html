<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.19" />
  <meta name="author" content="Jake Connor">
  

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <link rel="stylesheet" href="/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/academicons.min.css">
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  

  <link rel="alternate" href="https://gh.jakeconnor.com/index.xml" type="application/rss+xml" title="Jake Connor">
  <link rel="feed" href="https://gh.jakeconnor.com/index.xml" type="application/rss+xml" title="Jake Connor">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="https://gh.jakeconnor.com/post/Dual-Numbers/">

  

  <title>Using Dual Numbers to Automatically Find the Derivative of a Function | Jake Connor</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Jake Connor</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  
  <div class="article-header">
    <img src="/img//newt.gif" class="article-banner" itemprop="image">
    <span class="article-header-caption"><a href="http://www2.imng.uni-stuttgart.de/LstNumGeoMod/TCM/" target="_blank">http://www2.imng.uni-stuttgart.de/LstNumGeoMod/TCM/</a></span>
  </div>
  

  <div class="article-container">
    <h1 itemprop="name">Using Dual Numbers to Automatically Find the Derivative of a Function</h1>
    

<div class="article-metadata">

  <span class="article-date">
    <time datetime="2014-12-13 00:40:30 -0400 -0400" itemprop="datePublished">
      Sat, Dec 13, 2014
    </time>
  </span>

  

  
  
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fgh.jakeconnor.com%2fpost%2fDual-Numbers%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Using%20Dual%20Numbers%20to%20Automatically%20Find%20the%20Derivative%20of%20a%20Function&amp;url=https%3a%2f%2fgh.jakeconnor.com%2fpost%2fDual-Numbers%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fgh.jakeconnor.com%2fpost%2fDual-Numbers%2f&amp;title=Using%20Dual%20Numbers%20to%20Automatically%20Find%20the%20Derivative%20of%20a%20Function"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=https%3a%2f%2fgh.jakeconnor.com%2fpost%2fDual-Numbers%2f&amp;title=Using%20Dual%20Numbers%20to%20Automatically%20Find%20the%20Derivative%20of%20a%20Function"
         target="_blank">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Using%20Dual%20Numbers%20to%20Automatically%20Find%20the%20Derivative%20of%20a%20Function&amp;body=https%3a%2f%2fgh.jakeconnor.com%2fpost%2fDual-Numbers%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <p>Imaginary numbers are a powerful mathematical tool, however most people are only really familiar with the commonly used $i=\sqrt{-1}$. This is fair, because $i$ has uses in just about any technical field you can name, but there are others which have their own uses.</p>

<p>The dual numbers work by a definition similar to the complex numbers that $x = a + b\varepsilon$, where $\varepsilon$ is an imaginary number such that $\varepsilon^2=0$, but $\varepsilon \ne 0$</p>

<p>The usefulness of dual numbers appears when you consider the Taylor series expansion for a general function using $a+b\varepsilon$.</p>

<p>$f(a+b\varepsilon)=\sum_{n=0}^\infty \frac{f^{(n)}(a)b^n\varepsilon^n}{n!} = f(a)+bf^{&lsquo;}(a)\varepsilon$</p>

<p>Where higher order terms of $\varepsilon$ drop off because $\varepsilon^2 = 0$.</p>

<p>In programming, we can take advantage of this to retrieve both the value of a function and it&rsquo;s derivative, even in cases where we don&rsquo;t know the derivative, or even when the function is a black box.</p>

<p>Here&rsquo;s an example using Julia and the package DualNumbers, but similar packages exist for most common languages. The code below is a simple implementation of Newton&rsquo;s method for root finding, which is a good use because it allows us to use both the function value and its derivative from each function evaluation. (Note that each function evaluation will require more operations than we would by evaluating with a purely real number. This is because adding and subtracting require 2 operations each, and multiplication and division many more).</p>

<p>We start by defining the function under test in line 3, for this example it&rsquo;s a simple quadratic, but it certainly doesn&rsquo;t need to be. Line 4 defines our dual number, this syntax lets us set $x=5+1\varepsilon$. We then evaluate the function at x, and store this in y. The variable y now contains a dual number of the form $y=a+b\varepsilon$, where $a=f(5)$ and $b=\varepsilon\frac{d}{dx}f(5)$.</p>

<p>The actual work of netwons method is in line 10, where we set</p>

<p>$x^{*} = x - \frac{f(x)}{f^{&lsquo;}(x)}$</p>

<p>We use</p>

<pre><code class="language-matlab">real(y)
</code></pre>

<p>to retrieve the value of the function at x, and then</p>

<pre><code class="language-matlab">epsilon(y)
</code></pre>

<p>to find the derivative. We then find the new value of y, and continue refining x until converges. The results are shown below the code.</p>

<pre><code class="language-matlab">using DualNumbers

f(x) = x^2 - 2
x = dual(5,1);
y=f(x)

@printf &quot;\n\n%8s %12s %12s\n&quot; &quot;x&quot; &quot;y&quot; &quot;dy/dx&quot;

while abs(real(y)) &gt; 1e-8
     x = x - real(y)/epsilon(y)
     y = f(x)
     @printf &quot;%8f %8e %8e\n&quot; real(x) real(y) epsilon(y)
end

</code></pre>

<pre><code class="language-text">
       x              y          dy/dx
5.000000   2.300000e+01   1.000000e+01
2.700000   5.290000e+00   5.400000e+00
1.720370   9.596742e-01   3.440741e+00
1.441455   7.779358e-02   2.882911e+00
1.414471   7.281571e-04   2.828942e+00
1.414214   6.625248e-08   2.828427e+00
1.414214   4.440892e-16   2.828427e+00

</code></pre>

<p>It&rsquo;s worth noting that things don&rsquo;t to end here. By implementing your vectors using dual numbers rather than reals, you can easily compute gradients of multidimensional functions, or even the Jacobian of a vector-valued function.</p>

<p>If you want to retrieve the second derivative of a function as well (perhaps to implement Halley&rsquo;s Method), you can use Hyper-Dual numbers, which simply add another different $\varepsilon$, and have an associated Julia Package.</p>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="https://gh.jakeconnor.com/post/Parity-Spaces/"><span
      aria-hidden="true">&larr;</span> Adventures in Windows Parity Storage Spaces</a></li>
    

    
    <li class="next"><a href="https://gh.jakeconnor.com/post/Shors/">Shor&#39;s Algorithm, with Julia Examples <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.4/TweenMax.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/latest/plugins/ScrollToPlugin.min.js"></script>
    <script src="/js/jquery-1.12.3.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/isotope.pkgd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.1/imagesloaded.pkgd.min.js"></script>
    <script src="/js/hugo-academic.js"></script>
    

    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-36542974-1', 'auto');
        ga('send', 'pageview');

         
        var links = document.querySelectorAll('a');
        Array.prototype.map.call(links, function(item) {
            if (item.host != document.location.host) {
                item.addEventListener('click', function() {
                    var action = item.getAttribute('data-action') || 'follow';
                    ga('send', 'event', 'outbound', action, item.href);
                });
            }
        });
    </script>
    

    
    
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_SVG"></script>
    

  </body>
</html>

